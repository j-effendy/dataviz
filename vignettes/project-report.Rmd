---
title: "Project Report"
author: "Jimmy Effendy"
date: "13/10/2021"
output: bookdown::pdf_document2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(dataviz)
library(colorspace)
```

# Introduction (300)

According to Cleveland and McGill [-@cleveland1985graphical], data visualizations 
are effective tools for communicating quantitative information and presenting 
scientific data.

The aim of this project is to create a package that can produce figures that
are aesthetically cohesive for a textbook in an automatic and reproducible
manner. As these graphs are generally aimed to be consumed by other people, it
is important for the aesthetics to be engaging. More importantly, the style of 
the graphs needs to make it easier for users to compare and explore data.

# Themes (1500)

## What makes visualisations good? (300)

Azzam, Evergree, and Germuth [-@azzam2013data] stated that data visualization
is defined by three criteria: 

* A process that is based quantitative or qualitative data
* The result of the process is a graph that is representative of the raw data
* The graph is readable and support exploration, examination, and communications
of data.

Without careful considerations in building data visualizations, it has the 
potential to cause confusion resulting in misunderstanding or error in decision
makings [@evergreen2011]. In addition, inefficient visual decoding may result in
users to not detect important aspect of the data [@cleveland1993model]. Inefficient
graphs are not uncommon occurrence, especially with increasing number of options 
in data visualizations over the years. Tufte [-@tufte2001visual] found that 
prevalent errors and data misrepresentation were found in mass media. Another 
study found that 30% of graphs found in Volume 207 (1980) of *Science* have one 
or more type of errors [@cleveland1984graphs].

With the widespread error in data visualisations, guidelines on better graphs
for quantitative and qualitative data were established. According to Tufte 
[-@tufte2001visual] visualisations need to bring viewers' attention to the 
substance of the data as opposed to graphic design, methodology or something 
else. In addition, graphs should prevent distortion of the data, 
 and should encourage viewers to compare different parts of data. Another 
suggestion from Tufte is to avoid the usage of chartjunk. Chartjunk is any
decoration that do not provide new information to readers. This can easily cause
viewers to be confused or distracted from the data. Some examples of chartjunk
are moir√© effect, heavy grid lines, noisy background, a fake perspective (i.e. 
3-D charts).

Cleveland and McGill [-@cleveland1984graphical] conducted a study of effective
data visualisation based on graphical perception - humans' ability to visually
decode information encoded on graphs. In the study, people are given elementary
perceptual tasks to decode information from graphs. Then, the tasks are ordered
based on the accuracy of the performance. The order of the elementary tasks from 
most to least accurate is:

* Position along a common scale
* Positions along nonaligned scales
* Length, direction, angle
* Area
* Volume, curvature
* Shading, color saturation

## Roles of themes in data visualisation (300)

Themes in `ggplot` package refers to **non-data** components of data visualizations.
Themes allow users to customize plot background and title, axis line, ticks and 
title, legend position, background, and title, grid lines, etc. On default,
`ggplot` use `theme_grey` for every plots. However, `ggplot` provides other
complete themes that users can use, such as `theme_bw()` and `theme_minimal()`.

Theme is especially important for a research book where there are many authors
contribute to the book. Without a set theme, it is likely that each authors will 
have apply their own visualization styles for their research. Not only setting 
a theme for a research book assist allows authors not to spend their time to 
customize their plots' appearance, but it also allows research books to 
have consistency in their visualizations.

As stated in previous section, customizing plot themes is imperative in data 
visualizations as non-data ink impacts readers' ability to comprehend the graph.
However, maximizing data-ink ratio needs to be done cautiously as components of
the graph that provide useful information can be mistakenly removed.

Give plot examples.

## Criteria for good themes (300)

Tufte [-@tufte2001visual] introduced the term data-ink in his book. Data-ink
is defined as a non-redundant ink; it is ink used on a graph that represent
the underlying data. 

$$
\begin{aligned}
Data-ink ratio = \frac{data-ink}{total ink used to print the graphic}
\end{aligned}
$$

Five principles of data graphics in relation to data-ink are proposed by Tufte:

* Above all else show the data
* Maximise the data-ink ratio
* Erase non-data-ink, within reason
* Erase redundant data-ink
* Revise and edit

Two of these principles are related to non-data components of visualisations.
Good graphical representations can be achieved by reducing non-data ink as this
a way to maximise data-ink ratio. Graphical inks that provide no new information
about the underlying data are not beneficial to readers and sometimes result
graphical clutters.

Design choices on data visualizations need to allow information presented in an
organised fashion. For example, the color of non-data components (axis, labels, 
grid lines, borders) can be grey, and the data component can be brightly
colored, making the data to be the focus of attention [@stone2006choosing]. This
assists readers to better understand the roles and relationship between different
elements of the visualizations.


* For general plots - how to optimize the usability of data

## Potential themes (300)

```{r scatter-grey, fig.cap="A scatter plot example with 'theme_grey()'"}
g1 <- ggplot(mtcars, aes(mpg,disp,color=factor(carb))) + 
  geom_point(size=3) + 
  labs(title="Scatter Plot",
       subtitle = "theme_grey()",
       caption = "Data: mtcars")

g1
```

`theme_grey()` is the default `ggplot2` theme with grey background and white 
grid lines. These color combinations for background and grid lines as the 
background reduces the contrast and gives the data plots more value-added 
appearance [@carr1994using]. While having a grey background and white grid
lines have their benefits, some steps can be made to improve the plots. As
shown in figure \@ref(fig:scatter-grey), having a grey panel background  
on top of a white plot background unnecessarily increase non-data components.
In addition, having both major and minor grid lines distracts readers from 
real data, and rarely needed as data visualizations are not meant to provide
precise quantitative value [@few2005grid].

A ggplot theme is developed in `dataviz` package that is not only based on 
Tufte principles of data graphics, but also to create a theme that is suitable 
for a wide range of plots. There are two themes that were developed for 
`dataviz`: `theme_seagull()` and `theme_wombat()`.

### theme_seagull

```{r seagull-scatter, fig.cap="A scatter plot example with 'theme_seagull()'"}
s1 <- ggplot(mtcars, aes(mpg,disp,color=factor(carb))) + 
  geom_point(size=3) + 
  labs(title="Scatter Plot",
       subtitle = "theme_seagull()",
       caption = "Data: mtcars") +
  theme_seagull()

s1
```

This `ggplot2` theme is built based on `theme_minmal()`. The idea behind this
theme is to reduce non-data components as much as possible. `%+replace%` 
operator is used to change the elements of the plots. Axis line on the y axis 
is removed, and axis line on the x axis is thicker. Vertical Major grid lines 
and minor grid lines on both axis are removed. Horizontal major grid lines are
not removed as they can aid readers to approximate and compare values between
data points. Moreover, legend position, which is originally located to the
right of the plot, is moved to the bottom of the plot.

"Recently Cleveland (1993a, 1993b) has demonstrated that
background grids improve perceptual accuracy of extraction and help in making comparisons. 
The basic question now is how best to produce gentle background grids" [@carr1994using]

Another proposed figure style is `theme_seagull()`. An example of plot applied
with this style is shown in figure \@ref(fig:seagull-scatter). This theme is built
based on ggplot2 `theme_minmal()`. In comparison to `theme_wombat()`, this style
reduce clutter within a plot even further. The following adjustments are made
to the original `theme_minimal()`:

* Adding a major grid line on the x axis
* Removing minor grid lines on the x and y axis
* Maximising white space to improve legibility
* Removing extra space around the plot
* Move legend position to the bottom of the plot
* Having a bigger plot title, subtitle, and axis title

### theme_wombat

```{r wombat-scatter, fig.cap="A scatter plot example with 'theme_wombat()'"}
w1 <- ggplot(mtcars, aes(mpg,disp,color=factor(carb))) + 
  geom_point(size=3) + 
  labs(title="Scatter Plot",
       subtitle = "theme_wombat()",
       caption = "Data: mtcars") +
  #scale_y_continuous(expand = c(0.03,0.03)) + 
  #scale_x_continuous(expand = c(0.01,0.01)) +
  theme_wombat()

w1
```

`theme_wombat()` is developed based on `ggplot2` basic theme `theme_bw`.

The first figure aesthetic variant is called `theme_wombat()`. Figure 
\@ref(fig:wombat-scatter) shows a scatter plot that has been applied with 
`theme_wombat()`. This theme is built upon ggplot2 basic theme `theme_bw()`. One 
of the main goals of this style is to reduce clutter of plots. This is achieved 
by:

* Removing minor grid lines in the x and y axis
* Maximising white space to improve legibility
* Removing extra space around the plot
* Move legend position to the bottom of the plot
* Having a bigger plot title, subtitle, and axis title

## Comparing themes (300)

### Individual Plots

* Compare with each other and basic theme
* Advantage and disadvantage

```{r wombat-comparison, fig.cap="Comparison between theme_wombat (left) and theme_bw (right).", fig.height=14, fig.width=11}
w2 <- ggplot(mtcars, aes(factor(carb),fill=factor(carb))) + 
  geom_bar() + 
  scale_y_continuous(expand = c(0,0)) + 
  scale_x_discrete(expand = c(0,0)) +
  labs(title="Bar Plot",
       subtitle = "theme_wombat()",
       caption = "Data: mtcars") +
  theme_wombat()

w3 <- ggplot(economics_long, aes(date, value01, colour = variable)) +
  geom_line() +
   scale_y_continuous(expand = c(0,0)) + 
   scale_x_date(expand = c(0,0)) +
  labs(title = "Line Plot",
       subtitle = "theme_wombat()",
       caption = "Data: economics_long") +
  theme_wombat()

bw1 <- ggplot(mtcars, aes(mpg,disp,color=factor(carb))) + 
  geom_point(size=3) + 
  labs(title="Scatter Plot",
       subtitle = "theme_bw()",
       caption = "Data: mtcars") +
  theme_bw()

bw2 <- ggplot(mtcars, aes(factor(carb),fill=factor(carb))) + 
  geom_bar() + 
  labs(title="Bar Plot",
       subtitle = "theme_bw()",
       caption = "Data: mtcars") +
  theme_bw()

bw3 <- ggplot(economics_long, aes(date, value01, colour = variable)) +
  geom_line() +
  labs(title = "Line Plot",
       subtitle = "theme_bw()",
       caption = "Data: economics_long") +
  theme_bw()

(w1 + bw1) / (w2 + bw2) / (w3 + bw3)
```

Side by side comparison of scatter plots, bar charts, and line charts between
`theme_wombat` and `theme_bw()` can be found in figure \@ref(fig:wombat-comparison).
Figure \@ref(fig:wombat-facet) shows the comparison of faceted plot between
these two themes.

```{r seagull-comparison, fig.cap="Comparison between theme_seagull (left) and theme_minimal (right).", fig.height=14, fig.width=11}
s2 <- ggplot(mtcars, aes(factor(carb),fill=factor(carb))) + 
  geom_bar() + 
  scale_y_continuous(expand = c(0,0)) + 
  scale_x_discrete(expand = c(0,0)) +
  labs(title="Bar Plot",
       subtitle = "theme_seagull()",
       caption = "Data: mtcars") +
  theme_seagull()

s3 <- ggplot(economics_long, aes(date, value01, colour = variable)) +
  geom_line() +
  scale_y_continuous(expand = c(0,0)) + 
  scale_x_date(expand = c(0,0)) +
  labs(title = "Line Plot",
       subtitle = "theme_seagull()",
       caption = "Data: economics_long") +
  theme_seagull()

m1 <- ggplot(mtcars, aes(mpg,disp,color=factor(carb))) + 
  geom_point(size=3) + 
  labs(title="Scatter Plot",
       subtitle = "theme_minimal()",
       caption = "Data: mtcars") +
  theme_minimal()

m2 <- ggplot(mtcars, aes(factor(carb),fill=factor(carb))) + 
  geom_bar() + 
  labs(title="Bar Plot",
       subtitle = "theme_minimal()",
       caption = "Data: mtcars") +
  theme_minimal()

m3 <- ggplot(economics_long, aes(date, value01, colour = variable)) +
  geom_line() +
  labs(title = "Line Plot",
       subtitle = "theme_minimal()",
       caption = "Data: economics_long") +
  theme_minimal()

(s1 + m1) / (s2 + m2) / (s3 + m3)
```

Side by side comparison of scatter plots, bar charts, and line charts between
`theme_seagull()` and `theme_minimal()` can be found in figure 
\@ref(fig:seagull-comparison). Figure \@ref(fig:wombat-facet) shows the 
comparison of faceted plot between these two themes.

### Faceted Plots

```{r wombat-facet, fig.height=14, fig.width=11, fig.cap="Comparison between theme_wombat (top) and theme_bw (bottom) for faceted plot."}
w4 <- ggplot(data = mpg,aes(cty, hwy,color=drv))+geom_point(size=3) + 
  facet_wrap(~ class,scales="free")+
  labs(title="Plot With Facets",
       subtitle = "theme_wombat()",
       caption = "Data: mpg") + 
  theme_wombat()

bw4 <- ggplot(data = mpg,aes(cty, hwy,color=drv))+geom_point(size=3) + 
  facet_wrap(~ class,scales="free")+
  labs(title="Plot With Facets",
       subtitle = "theme_bw()",
       caption = "Data: mpg") + 
  theme_bw()

w4 / bw4
```

```{r seagull-facet, fig.height=14, fig.width=11, fig.cap="Comparison between theme_seagull (top) and theme_minimal (bottom) for faceted plot."}
s4 <- ggplot(data = mpg,aes(cty, hwy,color=drv))+geom_point(size=3) + 
  facet_wrap(~ class,scales="free")+
  labs(title="Plot With Facets",
       subtitle = "theme_seagull()",
       caption = "Data: mpg") + 
  theme_seagull()

m4 <- ggplot(data = mpg,aes(cty, hwy,color=drv))+geom_point(size=3) + 
  facet_wrap(~ class,scales="free")+
  labs(title="Plot With Facets",
       subtitle = "theme_minimal()",
       caption = "Data: mpg") + 
  theme_minimal()

s4 / m4
```


# Colour Palettes (1500)

## Why color is important and what it is use for (300)

* It can be used for representing different variable, etc.

One of the most important elements in data visualization. When used well, 
it can enhance the quality of information being presented.  It is essential
to select a color palette as a poor set of colors may hinder readers' ability
to understand the purpose of visualizations. Unfortunately, it is often the
case that color choice is sub-optimal as there is little guidance on how to
select effective colour palette for graphs [@zeileis2009escaping].

Stone [-@stone2006choosing] mentioned that differentiating one element from one
another is the most important use of color in data visualization.

## Color Model

* What potential color models are there?
* Benefits and disadvantage of each color model
* Discuss why do we choose HCL

According to Zeileis, Hornik, and Murrell [@zeileis2009escaping], Red-Green-Blue
(RGB) color model is typically used by software packages. However, this color
model was developed to generate color on computer screen as opposed to developed
in corresponds to human perception of color. Zeileis, Hornik, and Murrell further
stated that it is practically impossible for a human to control the perceptual
properties of a color within this color model as there is no single dimension
that relates to hue or brightness of a color

One color model that was developed based on human perception is 
Hue-Chroma-Luminance  (HCL) color model. Hue corresponds to dominant wavelength, 
chroma to colourfulness, luminance to brightness [@ihaka2003colour].

## Color scale types (300)

### Sequential

* Can talk about how Brewer did these color palettes

### Diverging

### Qualitative


* for qualitative, we need more variation in the hue line. Need to avoid
* implicit ordering
* make chroma and luminance to have patterns (but not the same with the others)

## Color palette of choice

### Sequential (200)

* Hue is increasing in a very smooth pattern. More prefer to use this for
* sequential for ordering

```{r seal}
seal_palette <- colorspace::sequential_hcl(7,
                                              h = c(0, -100),
                                              c = c(80,40),
                                              l = c(40, 75),
                                              power = c(1,1))

# color spectrum plot
specplot(seal_palette) 
# colorblind filter
pal.safe(seal_palette, main = "seal_palette")
```


```{r snake}
snake_palette <- colorspace::sequential_hcl(6,
                                              h = c(250, 90),
                                              c = c(40, 55),
                                              l = c(33,98),
                                              power = c(0.5,1),
                                              rev = TRUE)

# color spectrum plot
specplot(snake_palette)
# colorblind filter
pal.safe(snake_palette, main = "snake_palette")
```

* How did we choose them?
* Come from another package?
* How do we assess them?

* Talk about the HCL plot
* Talk about the accessibility
* Talk about how it should match the data

### Diverging (200)

```{r dingo}
dingo_palette <- colorspace::diverge_hcl(7,
                                           h = c(260, 0),
                                           c = 80,
                                           l = c(30, 90),
                                           power = 1.5)

# color spectrum plot
specplot(dingo_palette)
# colorblind filter
pal.safe(dingo_palette, main = "dingo_palette")
```

```{r dolphin}
# make the purple darker (modify hue)
dolphin_palette <- colorspace::diverging_hcl(n = 7,
                                             h = c(265, 45),
                                             c = 80,
                                             l = c(70, 95),
                                             power = c(0.5, 2),
                                             rev = TRUE)

# color spectrum plot
specplot(dolphin_palette)
# colorblind filter
pal.safe(dolphin_palette, main = "dolphin_palette")
```

### Qualitative (200)

```{r other-qualitative}
brewer_qualitative <- c("#a6cee3", "#1f78b4", "#b2df8a", "#33a02c")
tol_qualitative <- c("#4477AA", "#EE6677", "#228833", "#CCBB44", "#66CCEE", "#AA3377", "#BBBBBB")
```

```{r quokka}
quokka_palette <- c("#8C01E6", "#93B1EB", "#AB313D", "#D6CA24")

# color spectrum plot
specplot(quokka_palette)
# colorblind filter
pal.safe(quokka_palette, main = "quokka_palette")
```
Not ideal for Deutan and Protan because some of the colors looked paired.

```{r quoll}
quoll_palette <- c('#8D5698', '#EFD36F', '#247A3E', '#17B0A8')

# color spectrum plot
specplot(quoll_palette)
# colorblind filter
pal.safe(quoll_palette, main = "quoll_palette")
```

# R Package (1500)

## Components of R Package

## How dataviz was created

## Testing

# Conclusion (300)
